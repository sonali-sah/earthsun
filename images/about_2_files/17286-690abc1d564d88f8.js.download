"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[17286],{95807:(e,t,i)=>{i.d(t,{V:()=>r});let r=e=>{let{subscriptions:t,licenseName:i}=e;return null==t?void 0:t.find(e=>e.license===i)}},130682:(e,t,i)=>{i.d(t,{b:()=>s,q:()=>n});var r=i(930500),l=i(559044),a=i(48007);let n=e=>{let{uniqueSubscription:t}=e;if(!t)return{};let{priceAsAbsolute:i,creditCurrency:n,product:s}=t,o=(0,a.t)({subscription:t}),u=n??(null==s?void 0:s.currency);if(!i){let{creditPrice:e,creditType:i=r.EV}=t;return{price:`${(0,l.YO)({price:e,isUnlimited:o})}`,priceType:i,currency:u}}let{price:d,priceType:c}=i;return{price:`${(0,l.YO)({price:d,isUnlimited:o})}`,priceType:c,currency:u}},s=e=>{let{uniqueSubscription:t}=e;if(!t)return{};let{currency:i,currencyCost:a}=t;return{price:`${(0,l.YO)({price:a,isUnlimited:!1})}`,priceType:r.EV,currency:i}}},263739:(e,t,i)=>{i.d(t,{A:()=>_,As:()=>d,J_:()=>u,KC:()=>h,Wk:()=>v,en:()=>m,fy:()=>g,nR:()=>f,uO:()=>c,ul:()=>y,zZ:()=>b});var r=i(532598),l=i(813631),a=i(705992),n=i(485650),s=i(559044),o=i(531648);let u=e=>{var t,i;let{license:r,existingAssetsLicenses:l}=e;if(!l)return!((null==r?void 0:r.licenseName)&&n.t9I.includes(null==r?void 0:r.licenseName))&&l;let a=(0,o.xB)({asset:r.mediaItem});return!!(null==l||null==(t=l[null==(i=r.mediaItem)?void 0:i.id])?void 0:t.some(e=>e!==n.H8E[a]))},d=e=>{let{subscriptions:t=[]}=e;return t.some(e=>{let{redeemableFor:t}=e;return n.E11.some(e=>e===t)})?n.Ngi:n.jH2},c=e=>e.reduce((e,t)=>{let i=t.licenseId;return e.includes(i)||e.push(i),e},[]),m=e=>{let{alreadyLicensedAssets:t,asset:i}=e;return!!t.find(e=>{let{contentId:t,contentType:r,licenseId:a}=e,n=i.type===l.W1?l.vo:i.type;return t===i.id&&r===n&&a===i.licenseId})},p=e=>{let{licenseType:t,existingLicenses:i,asset:r,isSelect:l=!1}=e,a=[`footage_${t}_sd`,`footage_${t}_hd`],n=[...a,`footage_${t}_lowres`];return(l&&a.push(`footage_${t}_4k`),r.licenseId===`footage_${t}_sd`)?null==i?void 0:i.some(e=>!!a.includes(e)):r.licenseId===`footage_${t}_lowres`&&(null==i?void 0:i.some(e=>!!n.includes(e)))},v=e=>{let{existingLicenses:t,asset:i}=e;switch(i.type){case l.BI:case l.G_:if(n.dO2.some(e=>p({asset:i,licenseType:e,existingLicenses:t})))return!0;return!!(null==t?void 0:t.includes(i.licenseId));case l.W1:default:var r;return!!(null==t?void 0:t.includes(null==(r=i.licenseId)?void 0:r.replace(/_unlimited/,"")))}},h=e=>{let{error:t={},t:i}=e,{meta:r={}}=t;if((null==r?void 0:r.exception_type)===n.o__){let{value:e}=r.errors.slice(-1).pop(),t="comp_limit"===e.name;return i("P1M"===e.period_length?t?"ent:monthly_comp_limit_reached":"ent:monthly_licensing_limit_reached":t?"ent:daily_comp_limit_reached":"ent:daily_licensing_limit_reached")}return i("ent:license_now_error_message")},f=e=>{var t,i,r;let l,{error:s={},user:o={}}=e,{detail:u,headers:d={},message:c,meta:m={},name:p,source:v={},title:h}=s,{id:f,username:b,organizationId:g}=o||{},y=null==m?void 0:m.exception_type,_=(null==v||null==(t=v.request)?void 0:t.id)||(null==d?void 0:d[a.A2]);switch(y){case n.o__:{let e=null==(i=m.errors)?void 0:i.map(e=>{let{value:t}=e;return null==t?void 0:t.name});l=`${h}: ${e.join(",")}`;break}case n.Bxr:{let e=null==(r=m.errors)?void 0:r.map(e=>{let{code:t,value:i}=e;return`${t}: ${null==i?void 0:i.content_type} - ${null==i?void 0:i.content_id} - ${null==i?void 0:i.content_size}`});l=`${h}: ${e.join(",")}`;break}default:l=[y,h,u,c,p].reduce((e,t)=>t&&!e.includes(t)?[...e,t]:e,[]).join(", ")}return{organizationId:g,userId:f,username:b,errorSummary:l,error:s,requestId:_}},b=e=>{let{organizationId:t}=e;return`organization-${t}`},g=e=>{let{isEligibilityLoading:t,existingCurrentAssetLiceses:i}=e;return t?void 0:i||[]},y=e=>{let{asset:t,selectedLicenseId:i,activeFormatType:l,selectedShadowsOption:a}=e;return{...t,itemType:t.itemType||(0,o.Qk)({asset:t}),licenseId:i,...l===r.kr&&{licenseAsJpeg:!0},...(0,s.R1)(t)?{selectedFormatType:l,selectedShadowsOption:a}:{}}},_=e=>{let{assets:t=[]}=e;return t.length&&t.map(e=>e.licenseId).filter((e,t,i)=>i.indexOf(e)===t)||[]}},268958:(e,t,i)=>{i.d(t,{I:()=>l});var r=i(930500);let l=e=>{let{canShowLedgerLowBalance:t,hasInsufficientSubscriptionCredits:i=!1,units:l,amount:a,initialCommitment:n}=e;if(i)return!1;let s=r.Gy[l];return t&&s?Number(a)<=s:Number(a)<=Number(n)*r.O7}},366092:(e,t,i)=>{i.d(t,{_B:()=>J,Ym:()=>H,ng:()=>ee,Nc:()=>et,_R:()=>Z,Fh:()=>X,tS:()=>ei,gz:()=>el});var r=i(936479),l=i(487519),a=i(648973),n=i(532598),s=i(338436),o=i(813631),u=i(514264),d=i(345307),c=i(969185),m=i(915261),p=i(930500),v=i(693417),h=i(573923),f=i(116835),b=i(531648),g=i(559044),y=i(644783),_=i(871335),w=i(268958);let C=e=>{let{items:t,assetEligibleSubscriptions:i,canShowLedgerLowBalance:r}=e,l={hasInsufficientSubscriptionCredits:!1,hasLowDebitableBalance:!1,insufficientAmount:0,total:0,totalCreditAmount:0,amountType:p.mz};return t.reduce((e,t)=>{var a;let{licenseId:n,price:s,id:o}=t,u=null==i||null==(a=i[o])?void 0:a.licenseSubscriptions.find(e=>e.license===n);if(!u)return l;let{totalPrepaidAmount:d,prepaidAmountRemaining:c,currency:m,costType:p}=u,v=parseFloat(s),h=parseFloat(e.total)+v;return e.total+=v,"currency"===p&&h>c&&(e.hasInsufficientSubscriptionCredits=!0,e.hasLowDebitableBalance=!1,e.insufficientAmount=h-c),e.hasLowDebitableBalance=(0,w.I)({canShowLedgerLowBalance:r,hasInsufficientSubscriptionCredits:e.hasInsufficientSubscriptionCredits,units:m,amount:c,initialCommitment:d}),e},l)};var T=i(422207),I=i(48007),$=i(585076),A=i(560325),S=i(130682),k=i(957160),P=i(462430),j=i(867666),E=i(516319),x=i(355790),U=i(921075),B=i(238990),N=i(531950),O=i(524335),D=i(293251),L=i(12482),F=i(981278),q=i(455729),z=i(726988),M=i(498848),R=i(30721);let W="Size limit warning",V=e=>{var t;let{item:i,subscriptions:r}=e,{itemType:l,metadata:a}=i,n=(0,g.Q)({asset:i}),s=null==a||null==(t=a.cart)?void 0:t.licenseId,{allSubscriptions:u}=r;switch(l){case o.G_:return(0,k.d)({licenseName:s,subscriptions:u});case o.FY:case o.M9:case o.W1:default:return(0,A.A)({licenseName:s,subscriptions:u,assetType:l,contentTier:n})}},G=e=>{var t,i;let{item:r}=e;return(null==(t=r.largeThumb)?void 0:t.url)||(null==(i=r.preview)?void 0:i.url)||r.preview||r.thumb||""},K=e=>{var t;let{asset:i}=e;return i.itemType===o.W1&&!i.sizes&&!(null==(t=i.metadata)?void 0:t.cart.sizes)},Y=e=>{var t,i,r,l,a,n,u,d,c,m,p,v,h;let{item:f}=e,b=(0,g.$9)(f);if(f.itemType===o.m$){let e=null==f||null==(d=f.product)||null==(u=d.productPreviews[0])||null==(n=u.previewThumbnailImages)?void 0:n.find(e=>{let{resolution:t}=e;return"res600x600"===t}),t={[s.jx]:{height:600,width:600,src:`https://${null==e||null==(c=e.assetFile)?void 0:c.s3Path}`}};return{[s.jx]:{height:600,width:600,src:(0,y.c0)({...f,angle:null==f||null==(p=f.metadata)||null==(m=p.cart)?void 0:m.angle,displays:t})}}}return b?{[s.pI]:{height:f.height||(null==(v=f.preview)?void 0:v.height),width:f.width||(null==(h=f.preview)?void 0:h.width),src:f.preview||f.thumb}}:{[s.jx]:{height:(null==(t=f.largeThumb)?void 0:t.height)||(null==(i=f.preview)?void 0:i.height),width:(null==(r=f.largeThumb)?void 0:r.width)||(null==(l=f.preview)?void 0:l.width),src:null==(a=f.preview)?void 0:a.url}}},Q=e=>{var t,i,r,l,a,n,u,d,c,p,v,f,b,g,y,_,w,C;let{item:T,price:I,priceType:$,currency:A,subscriptionId:S,hasCreditsRemaining:k,isUnlimited:P,isUnavailableSubscription:j}=e,E=Y({item:T}),x=G({item:T}).replace("-150nw","-260nw")||(null==E||null==(t=E[s.jx])?void 0:t.src),U=null==(i=T.assets)?void 0:i.find(e=>{let{assetClass:t}=e;return t===m.Iw}),B=[o.m$,o.W1].includes(T.itemType)&&!T.src,N=null==T||null==(u=T.externalSource)||null==(n=u.details)||null==(a=n.pixelsquid)||null==(l=a.product)||null==(r=l.metadata)?void 0:r.isEditorial,O=null==(d=T.meta)?void 0:d.search_context;return(null==(p=T.metadata)||null==(c=p.cart)?void 0:c.searchContext)&&(O=(0,h.fF)({trackingId:null==(y=T.metadata)||null==(g=y.cart)||null==(b=g.searchContext)?void 0:b.searchTrackingId,searchTerm:null==(C=T.metadata)||null==(w=C.cart)||null==(_=w.searchContext)?void 0:_.searchTerm})),{...T,id:T.itemId,...[o.W1,o.m$,o.uH,o.rr].some(e=>e===T.itemType)&&{image:{id:T.itemId,categories:T.categories,description:T.description||T.subhead||"",url:x,isEditorial:!!T.isEditorial||!!N,isPremium:!!T.isPremium,displays:E,permalink:T.permalink,isIllustration:T.isIllustration,isVector:T.isVector}},type:T.itemType,isFootageSelect:T.footageSelect,price:I,priceType:$,waveformPng:T.waveformPng||(null==U?void 0:U.externalUrl),currency:A,licenseId:(null==(f=T.metadata)||null==(v=f.cart)?void 0:v.licenseId)||"",subscriptionId:S,hasCreditsRemaining:k,isPixelSquid:T.itemType===o.m$,isUnavailableAsset:K({asset:T}),isUnlimited:P,isUnavailableSubscription:j,meta:{...O?{search_context:O}:{}},...B&&{src:x}}},H=e=>{let{cartItems:t=[],subscriptions:i}=e;return t.filter(e=>[o.W1,o.m$,o.G_,o.FY,o.M9,o.uH,o.rr].includes(e.itemType)).map(e=>{let t=V({item:e,subscriptions:i}),{price:r=0,priceType:l=p.EV}=(0,S.q)({uniqueSubscription:t});return Q({item:e,price:r,priceType:l,currency:(null==t?void 0:t.creditCurrency)||"",subscriptionId:(null==t?void 0:t.id)||"-",isUnavailableSubscription:!t,hasCreditsRemaining:(0,T.X)({subscription:t}),isUnlimited:(0,I.t)({subscription:t})})})},J=e=>{let{isPrimary:t,isLedger:i=!1,isEnterpriseCartEndpointsMigration:a=!1}=e;if(a){let e=t?u.jT:u.pw;return(0,l.yT)({urlParams:{cartType:e},...i&&{queryParams:{isLedger:i}}}).formattedUrl}return(0,r.Xl)({urlParams:{isPrimary:t},...i&&{queryParams:{isLedger:i}}}).formattedUrl},Z=e=>{let{isPrimary:t}=e,i=(0,D.jE)(),r=(0,R.i9)(),{data:l}=(0,x.R7)(),{checkGate:a}=(0,O.U)(),n=a(c.Kk),s=J({isPrimary:t,isEnterpriseCartEndpointsMigration:n}),o=n?N.Bn:N.C2,{data:u,error:d,isLoading:m}=(0,L.I)({queryKey:[s],enabled:!!(r&&l),queryFn:()=>o.get(s).then(e=>{let{data:t}=e;return t&&{...t,items:H({cartItems:t.items,subscriptions:l})}}).catch(e=>{var t,i;throw null==(i=window.NREUM)||null==(t=i.recordCustomEvent)||t.call(i,v.s,{url:s,errorMessage:e.message,errorStack:e.stack}),e})});return{data:u,error:d,isLoading:m,mutate:async e=>e?i.setQueryData([s],e):i.invalidateQueries({queryKey:[s]})}},X=e=>{let{isPrimary:t}=e,i=(0,D.jE)(),r=(0,R.i9)(),{checkGate:l}=(0,O.U)(),a=l(c.Kk),n=J({isPrimary:t,isLedger:!0,isEnterpriseCartEndpointsMigration:a}),s=a?N.Bn:N.C2,{data:u}=(0,L.I)({queryKey:[n],enabled:r,queryFn:()=>s.get(n).then(e=>{let{data:t}=e;return t&&{...t,items:t.items.filter(e=>[o.W1,o.m$,o.G_,o.FY,o.M9,o.uH,o.rr].includes(e.itemType))}}).catch(e=>{var t,i;throw null==(i=window.NREUM)||null==(t=i.recordCustomEvent)||t.call(i,v.s,{url:n,errorMessage:e.message,errorStack:e.stack}),e})});return{data:u,mutate:async e=>e?i.setQueryData([n],e):i.invalidateQueries({queryKey:[n]})}},ee=e=>{let{cartItems:t=[],assetEligibleSubscriptions:i}=e;return t.map(e=>{var t;let{id:r,itemType:l,metadata:{cart:{licenseId:a}={}}={}}=e??{},n=(0,P.S)({assetType:l,subscriptions:null==i||null==(t=i[r])?void 0:t.licenseSubscriptions,selectedLicenseId:a}),{price:s=0,priceType:o=p.EV}=(0,S.b)({uniqueSubscription:n});return Q({item:e,price:s,priceType:o,currency:(null==n?void 0:n.currency)||(null==n?void 0:n.creditCurrency)||"",subscriptionId:(null==n?void 0:n.id)||"-",isUnavailableSubscription:!n,hasCreditsRemaining:!0,isUnlimited:(0,I.t)({subscription:n})})})},et=()=>{var e;let t=(0,D.jE)(),[i,s]=(0,q.useState)({status:"",error:void 0}),[m,p]=(0,q.useState)(!1),v=(0,q.useRef)(!1),{checkGate:h}=(0,O.U)(),g=h(c.Kk),{productAddedAnalyticsEvent:y,cartViewedAnalyticsEvent:_,productRemovedAnalyticsEvent:w}=(0,z.f)(),{getSearchContext:C}=(0,M.J)(),T=(0,F.useRouter)(),I=(0,B.O)(1e3),{queueIpReview:$}=(0,j.F)({trackingId:null==(e=C())?void 0:e.search_tracking_id,onComplete:I}),A=(0,q.useCallback)(e=>{void 0===(null==e?void 0:e.cartId)||v.current||(v.current=!0,_(e))},[v,_]),S=(0,q.useCallback)(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return e.filter(e=>{let{id:i}=e;return -1===t.findIndex(e=>{let{id:t}=e;return`${i}`==`${t}`})})},[]),k=(0,q.useCallback)(e=>{let{cartItems:t=[],itemsToAdd:i=[]}=e,r=[...t];return i.forEach(e=>{let t=(0,b.Qk)({asset:e}),i=r.findIndex(i=>{let{id:r,type:l}=i;return`${r}`==`${e.id}`&&l===t});i>-1?r[i]={...e}:r.unshift({...e,addedTime:new Date})}),r},[]),P=(0,q.useCallback)(async e=>{let{items:t,licenseId:i,licenseAsJpeg:r}=e;return Promise.all(null==t?void 0:t.map(async e=>{let t=(0,b.Qk)({asset:e}),l=i||e.licenseId,a=r||e.licenseAsJpeg,n=await (0,f.og)({asset:e,licenseName:l});return{item_id:e.id,item_type:t,metadata:{cart:{license_id:l,license_as_jpeg:a,subscription_id:e.subscriptionId,size:n.content_size,format:n.content_format,sizes:(0,f.Rj)({asset:e}),search_context:C(e),source:[o.uH,o.rr].some(e=>e===t)?d.Au:"",...t===o.m$&&{angle:n.angle}}}}}))},[C]),E=(0,q.useCallback)(async e=>{let{cart:i,eventLabel:o,gridItems:d,isPrimary:c=!0,itemsToAdd:m,licenseId:v,formatType:h,licensePrice:f,mutateCart:b,withOptimisticUpdate:_=!0,pageSection:T,listId:I}=e;try{let e=m.map(e=>({...e,meta:{search_context:C(e),...e.meta}}));s({status:"",error:void 0}),p(!1);let t=k({cartItems:i.items,itemsToAdd:e});if(t.length>u.Zm){s({status:a.Nz}),p(!0);return}_&&b(e=>({...e,items:t}));let A=await P({items:e,licenseId:v,licenseAsJpeg:h===n.kr});if(g){let e=c?u.jT:u.pw,t=(0,l.AG)({urlParams:{cartType:e}}).formattedUrl;await N.Bn.post(t,A)}else{let e=(0,r.bE)({urlParams:{isPrimary:c}}).formattedUrl;await N.C2.post(e,A)}s({status:a.qO}),$(m),c&&e.forEach(e=>{let t=i.items.find(t=>{let{id:i}=t;return`${i}`==`${e.id}`});t&&v!==t.licenseId&&w({cart:i,eventLabel:o,gridItems:d,items:[e],matchingCartItem:t,pageSection:T}),y({cart:i,eventLabel:o,gridItems:d,items:[e],licenseId:v,licensePrice:f,pageSection:T,listId:I})})}catch(e){s({status:a.Nz,error:e})}finally{await t.invalidateQueries({queryKey:[J({isPrimary:c,isLedger:!0,isEnterpriseCartEndpointsMigration:g})]}),await t.invalidateQueries({queryKey:[J({isPrimary:c,isEnterpriseCartEndpointsMigration:g})]})}},[k,P,C,y,w,t,$,g]),x=(0,q.useCallback)(async e=>{let{cartData:i,eventLabel:a,gridItems:n,isPrimary:s=!0,itemsToRemove:o=[],mutateCart:d,pageSection:c,routePathProps:m,withOptimisticUpdate:p=!0,mutateCallback:v}=e;try{p&&d(e=>({...e,items:S(e.items,o)}),!1);let e=null,t=null;if(g){let i=s?u.jT:u.pw;t=(0,l.v7)({urlParams:{cartType:i}}).formattedUrl,e=N.Bn}else t=(0,r.dt)({urlParams:{isPrimary:s}}).formattedUrl,e=N.C2;await e.delete(t,{data:o.map(e=>({item_id:e.id,item_type:(0,b.Qk)({asset:e})}))}),s&&w({cart:i,eventLabel:a,gridItems:n,items:o,pageSection:c}),m&&T.push(...m)}catch(e){}finally{v?v({isPrimary:s}):(await t.invalidateQueries({queryKey:[J({isPrimary:s,isLedger:!0,isEnterpriseCartEndpointsMigration:g})]}),await t.invalidateQueries({queryKey:[J({isPrimary:s,isEnterpriseCartEndpointsMigration:g})]}))}},[S,w,T,t,g]);return{triggerCartViewedEvent:A,addCartItems:E,removeCartItems:x,moveToSaveForLater:(0,q.useCallback)(async e=>{let{eventLabel:t,itemsToMove:i,pageSection:n,primaryCart:o,savedForLaterCart:d,mutatePrimaryCart:c,mutateSavedForLaterCart:m}=e;s({status:"",error:void 0}),p(!1);let v=k({cartItems:d.items,itemsToAdd:i});if(v.length>u.Zm)throw s({status:a.Nz}),p(!0),Error(W);c(e=>({...e,items:S(e.items,i)}),!1),m(e=>({...e,items:v}),!1);let h=g?(0,l.jO)({urlParams:{cartType:u.jT,destinationCartType:u.pw}}).formattedUrl:(0,r.cb)({urlParams:{fromCartType:u.jT,toCartType:u.pw}}).formattedUrl,f=await P({items:i}),b=g?N.Bn:N.C2;await b.post(h,f),w({cart:o,eventLabel:t,items:i,pageSection:n})},[k,P,w,S,g]),moveToPrimary:(0,q.useCallback)(async e=>{let{itemsToMove:t,primaryCart:i,mutatePrimaryCart:n,mutateSavedForLaterCart:o}=e;s({status:"",error:void 0}),p(!1);let d=k({cartItems:i.items,itemsToAdd:t});if(d.length>u.Zm)throw s({status:a.Nz}),p(!0),Error(W);o(e=>({...e,items:S(e.items,t)})),n(e=>({...e,items:d}));let c=g?(0,l.jO)({urlParams:{cartType:u.pw,destinationCartType:u.jT}}).formattedUrl:(0,r.cb)({urlParams:{fromCartType:u.pw,toCartType:u.jT}}).formattedUrl,m=await P({items:t}),v=g?N.Bn:N.C2;await v.post(c,m),y({cart:i,items:t})},[k,P,y,S,g]),addToCartStatus:i,setAddToCartStatus:s,isSizeLimitWarning:m}},ei=e=>{let{cartItems:t}=e,{data:i}=(0,x.R7)(),{isLoading:r,...l}=(0,U.h)(),a=(e=>{let{items:t}=e;return null==t?void 0:t.some(e=>{let{hasCreditsRemaining:t}=e;return!t})})({items:t}),{amountType:n,hasInsufficientSubscriptionCredits:s,insufficientAmount:o,hasLowDebitableBalance:u}=(0,$.E)({items:t,isLoading:!i||r,subscriptions:i,userCapabilities:l});return{amountType:n,isDebitableUser:(0,_.fY)({userCapabilities:l}),userCanViewDebitableBalance:(0,_.Pl)({userCapabilities:l}),hasInsufficientCartItemsCredits:a,hasInsufficientSubscriptionCredits:s,insufficientAmount:o,hasLowDebitableBalance:u}},er=e=>{let{items:t}=e;return null==t?void 0:t.some(e=>{let{hasCreditsRemaining:t}=e;return!t})},el=e=>{let{cartItems:t,assetEligibleSubscriptions:i}=e,{isLoading:r,...l}=(0,U.h)(),a=(0,E.k)();if(r)return{};let n=er({items:t}),{hasInsufficientSubscriptionCredits:s,insufficientAmount:o,hasLowDebitableBalance:u,amountType:d}=C({items:t,assetEligibleSubscriptions:i,canShowLedgerLowBalance:a})||{};return{amountType:d,isDebitableUser:(0,_.fY)({userCapabilities:l}),userCanViewDebitableBalance:(0,_.Pl)({userCapabilities:l}),hasInsufficientCartItemsCredits:n,hasInsufficientSubscriptionCredits:s,insufficientAmount:o,hasLowDebitableBalance:u}}},462430:(e,t,i)=>{i.d(t,{S:()=>n});var r=i(813631),l=i(95807),a=i(996887);let n=e=>{let{assetType:t,subscriptions:i,selectedLicenseId:n}=e;switch(t){case r.G_:return(0,a.K)({licenseName:n,subscriptions:i});case r.FY:case r.on:case r.M9:case r.W1:default:return(0,l.V)({subscriptions:i,licenseName:n})}}},478586:(e,t,i)=>{i.d(t,{Z:()=>n});var r=i(27489),l=i(543765),a=i(778042);let n=()=>{let e=(0,a.a)(),t=(0,l.Y)(),{openQuickViewCart:i}=(0,r.m)();return{viewCartAction:e?t:i}}},516319:(e,t,i)=>{i.d(t,{k:()=>l});var r=i(524335);let l=()=>{let{checkGate:e}=(0,r.U)();return e("lego-2245-ledger-low-balance")}},543765:(e,t,i)=>{i.d(t,{Y:()=>s});var r=i(323069),l=i(981278),a=i(455729),n=i(263896);let s=()=>{let e=(0,n.D)(),{isBrandSstk:t}=(0,r.P)(),i=(0,l.useRouter)();return(0,a.useCallback)(()=>{if(t){var r,l;null==(l=window.NREUM)||null==(r=l.addPageAction)||r.call(l,"UP3-1623 assign useCartRedirect cartHref to href",{...window.location||{},cartHref:e,isBrandSstk:t}),window.location.href=e}else i.push(e)},[e,t,i])}},585076:(e,t,i)=>{i.d(t,{E:()=>s});var r=i(930500),l=i(871335),a=i(10545),n=i(703399);let s=e=>{let t,{items:i,isLoading:s,subscription:o,subscriptions:u,userCapabilities:d}=e;return s?{}:(o&&(t=o.creditType),u&&u.length>0&&(t=u[0].creditType),(0,l.fY)({userCapabilities:d})?(0,n.h)({items:i,subscription:o,subscriptions:u,hasWrapperSubscription:(0,l.GT)({userCapabilities:d})}):{amountType:t||r.EV,hasLowDebitableBalance:!1,hasInsufficientSubscriptionCredits:o&&0===(0,a.J)({subscription:o}),insufficientAmount:null})}},594495:(e,t,i)=>{i.d(t,{mj:()=>u});var r=i(926114),l=i(302168),a=i(323069),n=i(568880),s=i(455729);let o="ent:license_",u=e=>{let{t}=(0,n.Bd)([r.Xek,r.fW6],{lng:e}),{isBrandSstk:i}=(0,a.P)();return(0,s.useCallback)(function(){let e,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{licenseName:n,subscription:s}=a;if(n&&(e=`${o}${n.replace(/_unlimited/,"")}`),s){if(i){var u,d;let i=null==(u=s.product)?void 0:u.name;if(i&&(0,l.l2)({productName:i}))return t(e=`product-names:${i}`,{ns:r.fW6});(null==(d=s.product)?void 0:d.name)&&(e=`ecomm:license_${s.product.name}`)}!i&&"redeemableFor"in s&&s.redeemableFor&&(e=`${o}${s.redeemableFor.replace(/_unlimited/,"")}`),!i&&"license"in s&&s.license&&(e=`${o}${s.license.replace(/_unlimited/,"")}`)}return e?t(e):""},[i,t])}},703399:(e,t,i)=>{i.d(t,{h:()=>u});var r=i(930500),l=i(871335),a=i(159658),n=i(302450),s=i(560325);let o=e=>{let{acc:t,totalCostOfItems:i,amountRemaining:l,totalAmount:a,bypassLowBalance:n=!1}=e;return n||(i>l&&(t.hasInsufficientSubscriptionCredits=!0,t.hasLowDebitableBalance=!1,t.insufficientAmount=i-l),!t.hasInsufficientSubscriptionCredits&&l<=a*r.O7&&(t.hasLowDebitableBalance=!0)),t},u=e=>{let{items:t,subscriptions:i,subscription:u,hasWrapperSubscription:d=!0}=e;if(t&&t.length){let e={hasInsufficientSubscriptionCredits:!1,hasLowDebitableBalance:!1,insufficientAmount:0,total:0,totalCreditAmount:0,amountType:r.EV};return t.reduce((e,t)=>{var c;let{licenseId:m,price:p}=t,v=(0,a.W)({assets:[t]}),h=u||(0,s.A)({subscriptions:null==(c=(0,n.s)({assetType:v,subscriptions:i}))?void 0:c.subscriptions,licenseName:m,assetType:v})||{},{totalAmount:f,amountRemaining:b,amountType:g,amount:y}=(0,l.hY)(h);e.amountType=g;let _=parseFloat(p),w=parseFloat(e.total)+_;if(e.total+=_,g===r.zy){let t=parseFloat(y),i=parseFloat(e.totalCreditAmount)+t;return e.totalCreditAmount+=t,o({acc:e,totalCostOfItems:i,amountRemaining:b,totalAmount:f,bypassLowBalance:!d})}return o({acc:e,totalCostOfItems:w,amountRemaining:b,totalAmount:f,bypassLowBalance:!d})},e)}let c=i||{},m=Object.keys(c).find(e=>Array.isArray(c[e])&&c[e].length),p=m&&(0,l.j6)({subscriptions:c[m]||[]})[0]||{},{totalAmount:v,amountRemaining:h,amountType:f}=(0,l.hY)(p);return{amountType:f,hasInsufficientSubscriptionCredits:!1,hasLowDebitableBalance:h<=v*r.O7,insufficientAmount:null}}},715549:(e,t,i)=>{i.d(t,{p:()=>l});var r=i(571024);let l=i.n(r)()(()=>Promise.all([i.e(27510),i.e(74782)]).then(i.bind(i,525742)).then(e=>({default:e.SignUpModal})),{loadableGenerated:{webpack:()=>[525742]},ssr:!1})},726988:(e,t,i)=>{i.d(t,{f:()=>o});var r=i(813631),l=i(573923),a=i(498848),n=i(586694),s=i(455729);let o=()=>{let{analytics:e}=(0,n.pn)(),{getSearchContext:t}=(0,a.J)(),i=(0,s.useCallback)(t=>{let{cartId:i,items:r}=t,a=(r||[]).map((e,t)=>(0,l.Aj)({asset:e,cartId:i,index:t})),n=a.reduce((e,t)=>({totalPrice:e.totalPrice+Number(t.price),toBeBilled:e.toBeBilled+1}),{totalPrice:0,toBeBilled:0});e.cartViewed({products:a,cartId:i,cartTotal:Math.round(100*n.totalPrice)/100,numItemsBilledToCard:n.toBeBilled,shouldCheckout:n.totalPrice>0,shouldDownload:a.length>0&&0===n.totalPrice})},[e]);return{productAddedAnalyticsEvent:(0,s.useCallback)(i=>{let{cart:r,eventLabel:a,gridItems:n,items:s,licenseId:o,licensePrice:u,listId:d,pageSection:c}=i;e.productAdded({products:s.map(e=>(0,l.Un)({asset:e,cartData:r,getSearchContext:t,gridItems:n,licenseId:o,licensePrice:u,pageSection:c})),eventLabel:a,list_id:d??""})},[e,t]),productRemovedAnalyticsEvent:(0,s.useCallback)(i=>{let{cart:a,eventLabel:n,gridItems:s,items:o,listId:u,matchingCartItem:d,pageSection:c}=i;if(d){let[i]=o;e.productRemoved({...(0,l.Un)({asset:i,cartData:a,getSearchContext:t,gridItems:s,pageSection:c}),price:d.price===r.Mp?0:Number(d.price),variant:d.licenseId,eventLabel:n,list_id:u??""})}else e.productRemoved({products:o.map(e=>(0,l.Un)({asset:e,cartData:a,getSearchContext:t,gridItems:s,pageSection:c})),eventLabel:n,list_id:u??""})},[e,t]),cartViewedAnalyticsEvent:i}}},836640:(e,t,i)=>{i.d(t,{A:()=>n});var r=i(969185),l=i(921075),a=i(524335);let n=()=>{var e,t;let i=(0,l.h)(),n=null==i?void 0:i.userCanViewPortfolio,{checkGate:s}=(0,a.U)(),o=s(r.V_),u=null==i||null==(t=i.debugCohorts)||null==(e=t.active)?void 0:e.CohortEnterprisePrePaid;return n||o&&u}},936479:(e,t,i)=>{i.d(t,{Df:()=>m,WP:()=>d,Xl:()=>n,bE:()=>o,bR:()=>v,cb:()=>u,dt:()=>s,fh:()=>p,h_:()=>c,vY:()=>f,vv:()=>h});var r=i(514264),l=i(940252);let a=e=>{let{urlParams:t={},queryParams:i={}}=e,a=`/cart/${t.isPrimary?r.jT:r.pw}`,n={...i};return{url:a,defaultParams:n,formattedUrl:(0,l.format)({pathname:a,query:n})}},n=function(){let{urlParams:e={},queryParams:t={}}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=a({urlParams:e,queryParams:t}),r={...i.defaultParams};return{...i,defaultParams:r,formattedUrl:(0,l.format)({pathname:i.url,query:r})}},s=a,o=a,u=e=>{let{urlParams:t={},queryParams:i={}}=e,r=`/cart/${t.fromCartType}/to/${t.toCartType}`,a={...i};return{url:r,defaultParams:a,formattedUrl:(0,l.format)({pathname:r,query:a})}},d=e=>{let{urlParams:t={}}=e,i=`/organization/${t.organizationId}/invitations/${t.status}`;return{url:i,formattedUrl:(0,l.format)({pathname:i})}},c=e=>{let{urlParams:t={}}=e,i=`/account/user/${t.id}/settings`;return{url:i,formattedUrl:(0,l.format)({pathname:i})}},m=e=>{let{urlParams:t={}}=e,i=`/account/user/${t.id}/settings`;return{url:i,formattedUrl:(0,l.format)({pathname:i})}},p=e=>{let{urlParams:t={}}=e,i=`/organization/${t.organizationId}/invitations/${t.invitationId}`;return{url:i,formattedUrl:(0,l.format)({pathname:i})}},v=e=>{let{urlParams:t={}}=e,i=`/organization/${t.organizationId}/invitations`;return{url:i,formattedUrl:(0,l.format)({pathname:i})}},h=e=>{let{urlParams:t={}}=e,i=`/organization/users/${t.id}`;return{url:i,formattedUrl:(0,l.format)({pathname:i})}},f=function(){let{queryParams:e={}}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=`/cart/${r.jT}/quote`,i={...e,exclude_comps:1,expand:"agreements"};return{url:t,defaultParams:i,formattedUrl:(0,l.format)({pathname:t,query:i})}}},963228:(e,t,i)=>{i.d(t,{Z:()=>r});let r=e=>e&&"string"==typeof e?`${e.charAt(0).toUpperCase()}${e.slice(1)}`:""},973681:(e,t,i)=>{i.d(t,{z:()=>I,k:()=>$});var r=i(406029),l=i(366092),a=i(213304),n=i(455729),s=i(836640),o=i(571024),u=i.n(o);let d=u()(()=>Promise.all([i.e(27510),i.e(72076),i.e(10382),i.e(48417),i.e(77618),i.e(6838),i.e(737),i.e(26300),i.e(27273)]).then(i.bind(i,695695)).then(e=>({default:e.AddToCartDialog})),{loadableGenerated:{webpack:()=>[695695]},ssr:!1}),c=u()(()=>Promise.all([i.e(27510),i.e(72076),i.e(10382),i.e(48417),i.e(77618),i.e(6838),i.e(737),i.e(26300),i.e(27273),i.e(49414)]).then(i.bind(i,63882)).then(e=>({default:e.AddToCartDialogLedger})),{loadableGenerated:{webpack:()=>[63882]},ssr:!1}),m=e=>{let{isActive:t,...i}=e,l=(0,a.G)(t),n=(0,s.A)();return l&&(0,r.jsx)(n?c:d,{isActive:t,...i})};var p=i(926114),v=i(478586),h=i(470235),f=i(648973),b=i(514264),g=i(543765),y=i(323069),_=i(568880);let w=e=>{let{status:t,isSizeLimitWarning:i,alertLabels:r}=e;return i?r.sizeLimitWarning:t===f.qO?r.addToCartSuccess:r.addToCartWarning},C=e=>{let{isOpen:t,isSizeLimitWarning:i=!1,addToCartStatus:l,snackBarActionAllowed:a=!0,handleSnackbarClose:n}=e,{t:s}=(0,_.Bd)(p.evH),{status:o,error:u}=l,d={addToCartSuccess:s("common:actions_added_to_cart"),addToCartWarning:s("notifications:label_add_to_cart_failure"),sizeLimitWarning:s("ent:cart_size_limit_warning",{LIMIT:b.Zm}),viewActionLabel:s("common:actions_view")},c=w({status:o,isSizeLimitWarning:i,alertLabels:d}),{isBrandEnterprise:m}=(0,y.P)(),{viewCartAction:C}=(0,v.Z)(),T=(0,g.Y)(),I={onClick:()=>{n(),m?T():C()},label:d.viewActionLabel};return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(h.DynamicSnackbar,{...l.status===f.qO&&a&&{alertAction:I},alertSeverity:o,error:u,handleSnackbarClose:n,isOpen:t&&!!o,message:c})})},T={status:"",error:void 0},I=e=>{let{addToCartStatus:t=T,assets:i=null,eventLabel:l,gridItems:n=null,isAddToCartDialogActive:s,isPrimary:o,isSnackBarOpen:u,isSizeLimitWarning:d,onAddToCart:c,onAlertSnackbarClose:p,setIsAddToCartDialogActive:v,pageSection:h,listId:f,snackBarActionAllowed:b=!0}=e;return(0,a.G)(i)?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(m,{assets:i,eventLabel:l,gridItems:n,isActive:s,isPrimary:o,listId:f,onAddToCart:c,pageSection:h,setIsActive:v}),(0,r.jsx)(C,{snackBarActionAllowed:b,addToCartStatus:t,handleSnackbarClose:p,isOpen:u,isSizeLimitWarning:d})]}):null},$=function(){let{withOptimisticUpdate:e=!0,setIsVerifying:t,snackBarActionAllowed:i=!0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},[r,a]=(0,n.useState)(!1),[s,o]=(0,n.useState)(!1),[u,d]=(0,n.useState)(null),[c,m]=(0,n.useState)(null),[p,v]=(0,n.useState)(!0),[h,f]=(0,n.useState)(null),[b,g]=(0,n.useState)(null),[y,_]=(0,n.useState)(null),{addCartItems:w,moveToSaveForLater:C,moveToPrimary:T,addToCartStatus:$,isSizeLimitWarning:A,notAddedSelectVideos:S}=(0,l.Nc)();(0,n.useEffect)(()=>()=>d(null),[]);let k=(0,n.useCallback)(i=>{let{assets:r,eventLabel:l,licenseId:a,formatType:n,licensePrice:s,cart:d,mutateCart:m,notAddedSelectVideoIds:v,pageSection:h,listId:f}=i;null==t||t(!0),o(!0),w({cart:d,eventLabel:l,gridItems:c,isPrimary:p,itemsToAdd:r||u,licenseId:a,formatType:n,licensePrice:s,mutateCart:m,notAddedSelectVideoIds:v,withOptimisticUpdate:e,pageSection:h,listId:f})},[u,c,w,p,t,e]),P=(0,n.useCallback)(async e=>{let{itemsToMove:i,primaryCart:r,mutatePrimaryCart:l,mutateSavedForLaterCart:a}=e;null==t||t(!0),o(!0);try{await T({itemsToMove:i,primaryCart:r,mutatePrimaryCart:l,mutateSavedForLaterCart:a})}catch(e){null==t||t(!1)}},[T,t]),j=(0,n.useCallback)(async e=>{let{itemsToMove:i,primaryCart:r,savedForLaterCart:l,mutatePrimaryCart:a,mutateSavedForLaterCart:n}=e;null==t||t(!0),o(!0);try{await C({itemsToMove:i,primaryCart:r,savedForLaterCart:l,mutatePrimaryCart:a,mutateSavedForLaterCart:n})}catch(e){null==t||t(!1)}},[C,t]);return{addToCartViewsProps:(0,n.useMemo)(()=>({addToCartStatus:$,assets:u,eventLabel:y,gridItems:c,isAddToCartDialogActive:r,isPrimary:p,isSizeLimitWarning:A,isSnackBarOpen:s,onAddToCart:k,onAlertSnackbarClose:()=>o(!1),notAddedSelectVideos:S,setIsAddToCartDialogActive:a,pageSection:h,listId:b,snackBarActionAllowed:i}),[u,c,$,y,b,h,r,p,A,s,S,k,i]),addToCartViewsHandler:(0,n.useCallback)(e=>{let{assets:t,eventLabel:i,gridItems:r,isMoveToPrimaryCart:l=!1,isMoveToSavedForLaterCart:n=!1,isPrimaryCart:s=!0,mutatePrimaryCart:o,mutateSavedForLaterCart:u,primaryCart:c,savedForLaterCart:p,withDialog:h=!0,licenseId:b,licensePrice:y,pageSection:w,listId:C}=e;return(d(t),v(s),f(w),_(i),g(C),r&&m(r),l)?void P({itemsToMove:t,primaryCart:c,mutatePrimaryCart:o,mutateSavedForLaterCart:u}):n?void j({itemsToMove:t,primaryCart:c,savedForLaterCart:p,mutatePrimaryCart:o,mutateSavedForLaterCart:u}):void(h?a(!0):k({assets:t,eventLabel:i,cart:c,licenseId:b,licensePrice:y,mutateCart:o,pageSection:w}))},[k,P,j]),AddToCartViews:I}}},995683:(e,t,i)=>{i.r(t),i.d(t,{MosaicAssetGridWithViews:()=>b});var r=i(406029),l=i(540943),a=i(32584),n=i(506987),s=i(973681),o=i(245371),u=i(715549),d=i(559044),c=i(633449);let m=e=>{let{assetOverlayProps:t,...i}=e,{assets:l,hideAddToCart:m,hideSimilarAction:p,onAddToCollectionsComplete:v,listId:h,showInlineSimilarity:f}=i,{assetType:b}=(0,c.BF)(),{AddToCartViews:g,addToCartViewsHandler:y,addToCartViewsProps:_}=(0,s.k)(),{AddToCollectionViews:w,addToCollectionViewsHandler:C,addToCollectionViewsProps:T,isModalOpen:I,handleCloseModal:$,collectionProps:A}=(0,o.X)({initialAssetType:b}),{PreviewModal:S,previewModalProps:k,onAssetModalHandler:P}=(0,n.l)({addToCartViewsHandler:y,addToCollectionViewsHandler:C,assets:l,compLicensingHandler:null,licensingAssetId:null,withGoToPageAction:!0,withNavigationArrows:!0,listId:h,SecondaryActionsComponent:void 0,analyticsEventSection:void 0}),j=(0,d.sD)(null==l?void 0:l[0]);return(0,r.jsxs)(r.Fragment,{children:[I&&(0,r.jsx)(u.p,{modalIsOpen:I,handleClose:$,...j&&{collectionProps:A}}),(0,r.jsx)(a.MosaicAssetGrid,{assetOverlayProps:{listId:h,addToCartViewsHandler:y,addToCollectionViewsHandler:C,onAssetModalHandler:P,shouldHideOnImageMobile:!0,...t},showInlineSimilarity:f,...i}),(0,r.jsx)(g,{..._}),(0,r.jsx)(w,{onAddToCollectionsComplete:v,...T}),(0,r.jsx)(S,{...k,hideAddToCart:m,hideSimilarAction:p,showActionIcons:!0})]})};var p=i(64984);let v=e=>{let{assetOverlayProps:t,...i}=e,{assets:l,hideAddToCart:u,onAddToCollectionsComplete:d,listId:m,showInlineSimilarity:v}=i,{assetType:h}=(0,c.BF)(),{CompLicensingViews:f,licensingAssetId:b,compLicensingProps:g,compLicensingHandler:y}=(0,p.x)(),{AddToCartViews:_,addToCartViewsHandler:w,addToCartViewsProps:C}=(0,s.k)(),{AddToCollectionViews:T,addToCollectionViewsHandler:I,addToCollectionViewsProps:$}=(0,o.X)({initialAssetType:h}),{PreviewModal:A,previewModalProps:S,onAssetModalHandler:k}=(0,n.l)({addToCartViewsHandler:w,addToCollectionViewsHandler:I,assets:l,compLicensingHandler:y,licensingAssetId:b,withGoToPageAction:!0,withNavigationArrows:!0,listId:m,SecondaryActionsComponent:void 0,analyticsEventSection:void 0});return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(a.MosaicAssetGrid,{assetOverlayProps:{listId:m,addToCartViewsHandler:w,addToCollectionViewsHandler:I,compLicensingHandler:y,licensingAssetId:b,onAssetModalHandler:k,...t},showInlineSimilarity:v,...i}),(0,r.jsx)(_,{...C}),(0,r.jsx)(T,{onAddToCollectionsComplete:d,...$}),(0,r.jsx)(A,{...S,hideAddToCart:u,showActionIcons:!0}),(0,r.jsx)(f,{...g})]})};var h=i(323069),f=i(778042);let b=e=>{let{setThroughProvider:t,assets:i,isBrandSstk:a}=(0,l.N)(),{isBrandEnterprise:n}=(0,h.P)(),s=(0,f.a)(),{assets:o}=e,u=t?i:o;switch(`${s?"MOBILE":"DESKTOP"}_${(t?a:!n)?"ECOMM":"ENTERPRISE"}`){case"MOBILE_ENTERPRISE":case"DESKTOP_ENTERPRISE":return(0,r.jsx)(v,{...e,assets:u});default:return(0,r.jsx)(m,{...e,assets:u})}}},996887:(e,t,i)=>{i.d(t,{K:()=>s});var r=i(485650),l=i(95807);let a=e=>{let t,{licenses:i,subscriptions:r}=e;return i.some(e=>t=(0,l.V)({subscriptions:r,licenseName:e})),t},n=e=>{let{existingAssetLicenses:t,licenseType:i,licenseName:r,subscriptions:l}=e;return r===`footage_${i}_sd`?a({licenses:(null==t?void 0:t.includes(`footage_${i}_hd`))?[`footage_${i}_hd`]:[`footage_${i}_sd`,`footage_${i}_hd`],subscriptions:l}):r===`footage_${i}_lowres`?(null==t?void 0:t.includes(`footage_${i}_hd`))?a({licenses:[`footage_${i}_hd`],subscriptions:l}):(null==t?void 0:t.includes(`footage_${i}_sd`))?a({licenses:[`footage_${i}_sd`],subscriptions:l}):a({licenses:[`footage_${i}_lowres`],subscriptions:l}):void 0},s=e=>{let{existingAssetLicenses:t,subscriptions:i,licenseName:a}=e;if([r.UiI,r.eJJ,r.P2I,r.vWp,r.N8V,r.j35,r.eS$,r.Kwu,r.O_b,r.OSP,r.FO6,r.Fc7].some(e=>e===a)||r.CkD.some(e=>e===a))return(0,l.V)({subscriptions:i,licenseName:a});if([r.eNn,r.AWs,r.H8O,r.GO9].some(e=>e===a))return(0,l.V)({subscriptions:i,licenseName:r.eNn});let s=n({existingAssetLicenses:t,licenseType:r.$Me,licenseName:a,subscriptions:i}),o=n({existingAssetLicenses:t,licenseType:r.Lyy,licenseName:a,subscriptions:i}),u=n({existingAssetLicenses:t,licenseType:r.kTi,licenseName:a,subscriptions:i}),d=n({existingAssetLicenses:t,licenseType:r.IDD,licenseName:a,subscriptions:i});return s||o||u||d||void 0}}}]);
//# sourceMappingURL=17286-690abc1d564d88f8.js.map